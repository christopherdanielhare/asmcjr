dfs$id <- rownames(dfs)
if(!is.null(selected.stims)){
dfs <- dfs[which(rownames(dfs) %in% selected.stims), ]
}
df <- rbind(dfi, dfs)
levs <- unique(df$id)
levs <- levs[-which(levs == "Stimulus")]
df$id <- factor(df$id, c(sort(levs), "Stimulus"))
df
dfi <- x$inds
if(is.null(dfi$id)){
dfi$id <- "A"
}
dfi$id <- as.character(dfi$id)
dfii <- sort(unique(dfi$id))
dfs <- x$stims
dfs$id <- rownames(dfs)
if(!is.null(selected.stims)){
dfs <- dfs[which(rownames(dfs) %in% selected.stims), ]
}
df <- rbind(dfi, dfs)
levs <- unique(df$id)
dfi <- x$inds
if(is.null(dfi$id)){
dfi$id <- "A"
}
dfi$id <- as.character(dfi$id)
dfii <- sort(unique(dfi$id))
dfs <- x$stims
dfs$id <- rownames(dfs)
if(!is.null(selected.stims)){
dfs <- dfs[which(rownames(dfs) %in% selected.stims), ]
}
df <- rbind(dfi, dfs)
levs <- unique(df$id)
levs1 <- dfii
levs2 <- dfs$id
df$id <- factor(df$id, c(sort(levs1), sort(levs2)))
df
ggplot(df, aes(x=Dim1, y=Dim2, label=id, colour=id)) +
geom_text(aes(size=1.5), show.legend=FALSE) +
scale_colour_manual(values=c("gray25", "gray50", rep("black", nrow(dfs))), guide="none") +  theme_bw() + theme(aspect.ratio=1)
ggplot(df, aes(x=Dim1, y=Dim2, label=id, colour=id, size=id)) +
geom_text(aes(size=id), show.legend=FALSE) +
scale_colour_manual(values=c("gray25", "gray50", rep("black", nrow(dfs))), guide="none") +
scale_size_manual(values=c(rep(1.25, length(dfii)), rep(2, nrow(dfs)))) +
theme_bw() + theme(aspect.ratio=1)
ggplot(df, aes(x=Dim1, y=Dim2, label=id, colour=id, size=id)) +
geom_text(show.legend=FALSE) +
scale_colour_manual(values=c("gray25", "gray50", rep("black", nrow(dfs))), guide="none") +
scale_size_manual(values=c(rep(1.25, length(dfii)), rep(2, nrow(dfs)))) +
theme_bw() + theme(aspect.ratio=1)
c(rep(1.25, length(dfii)), rep(2, nrow(dfs)))
ggplot(df, aes(x=Dim1, y=Dim2, label=id, colour=id, size=id)) +
geom_text(show.legend=FALSE) +
scale_colour_manual(values=c("gray25", "gray50", rep("black", nrow(dfs))), guide="none") +
scale_size_manual(values=c(rep(1.25, length(dfii)), rep(2, nrow(dfs)))) +
theme_bw() + theme(aspect.ratio=1)
ggplot(df, aes(x=Dim1, y=Dim2, label=id, colour=id, size=id)) +
geom_text(show.legend=FALSE) +
scale_colour_manual(values=c("gray25", "gray50", rep("black", nrow(dfs))), guide="none") +
scale_size_manual(values=c(rep(12.5, length(dfii)), rep(20, nrow(dfs)))) +
theme_bw() + theme(aspect.ratio=1)
ggplot(df, aes(x=Dim1, y=Dim2, label=id, colour=id, size=id)) +
geom_text(show.legend=FALSE) +
scale_colour_manual(values=c("gray25", "gray50", rep("black", nrow(dfs))), guide="none") +
scale_size_manual(values=c(rep(5, length(dfii)), rep(8, nrow(dfs)))) +
theme_bw() + theme(aspect.ratio=1)
ggplot(df, aes(x=Dim1, y=Dim2, label=id, colour=id, size=id)) +
geom_text(show.legend=FALSE) +
scale_colour_manual(values=c("gray25", "gray50", rep("black", nrow(dfs))), guide="none") +
scale_size_manual(values=c(rep(3, length(dfii)), rep(6, nrow(dfs)))) +
theme_bw() + theme(aspect.ratio=1)
ind.id.size=3; stim.id.size=6
ggplot(df, aes(x=Dim1, y=Dim2, label=id, colour=id, size=id)) +
geom_text(show.legend=FALSE) +
scale_colour_manual(values=c("gray25", "gray50", rep("black", nrow(dfs))), guide="none") +
scale_size_manual(values=c(rep(ind.id.size, length(dfii)), rep(stim.id.size, nrow(dfs)))) +
theme_bw() + theme(aspect.ratio=1)
ggplot(df, aes(x=Dim1, y=Dim2, label=id, colour=id, size=id)) +
geom_text(show.legend=FALSE) +
scale_colour_manual(values=c("gray25", "gray50", rep("black", nrow(dfs))), breaks=dfii) +
scale_size_manual(values=c(rep(ind.id.size, length(dfii)), rep(stim.id.size, nrow(dfs)))) +
theme_bw() + theme(aspect.ratio=1)
ggplot(df, aes(x=Dim1, y=Dim2, label=id, colour=id, size=id)) +
geom_text(show.legend=FALSE) +
scale_colour_manual(values=c("gray25", "gray50", rep("black", nrow(dfs))), guide="none") +
scale_size_manual(values=c(rep(ind.id.size, length(dfii)), rep(stim.id.size, nrow(dfs)))) +
scale_shape_discrete(name="ID", breaks=dfii, labels=dfii) +
theme_bw() + theme(aspect.ratio=1)
ggplot(df, aes(x=Dim1, y=Dim2, label=id, colour=id, size=id)) +
geom_text(show.legend=FALSE) +
scale_colour_manual(values=c("gray25", "gray50", rep("black", nrow(dfs)))) +
scale_size_manual(values=c(rep(ind.id.size, length(dfii)), rep(stim.id.size, nrow(dfs)))) +
scale_shape_discrete(name="ID", breaks=dfii, labels=dfii) +
theme_bw() + theme(aspect.ratio=1)
ggplot(df, aes(x=Dim1, y=Dim2, label=id, colour=id, size=id)) +
geom_text() +
scale_colour_manual(values=c("gray25", "gray50", rep("black", nrow(dfs)))) +
scale_size_manual(values=c(rep(ind.id.size, length(dfii)), rep(stim.id.size, nrow(dfs)))) +
scale_shape_discrete(name="ID", breaks=dfii, labels=dfii) +
theme_bw() + theme(aspect.ratio=1)
ggplot(df, aes(x=Dim1, y=Dim2, label=id, colour=id, size=id)) +
geom_text() +
scale_colour_manual(values=c("gray25", "gray50", rep("black", nrow(dfs))), guide="none") +
scale_size_manual(values=c(rep(ind.id.size, length(dfii)), rep(stim.id.size, nrow(dfs)))) +
scale_shape_discrete(name="ID", breaks=dfii, labels=dfii) +
theme_bw() + theme(aspect.ratio=1)
ggplot(df, aes(x=Dim1, y=Dim2, label=id, colour=id, size=id)) +
geom_text(show.legend=FALSE) +
scale_colour_manual(values=c("gray25", "gray50", rep("black", nrow(dfs))), guide="none") +
scale_size_manual(values=c(rep(ind.id.size, length(dfii)), rep(stim.id.size, nrow(dfs)))) +
scale_shape_discrete(name="ID", breaks=dfii, labels=dfii) +
theme_bw() + theme(aspect.ratio=1)
plot.mlsmu6 <- function(x, ..., selected.stims=NULL, ind.id.size=3, stim.id.size=6){
dfi <- x$inds
if(is.null(dfi$id)){
dfi$id <- "x"
}
dfi$id <- as.character(dfi$id)
dfii <- sort(unique(dfi$id))
dfs <- x$stims
dfs$id <- rownames(dfs)
if(!is.null(selected.stims)){
dfs <- dfs[which(rownames(dfs) %in% selected.stims), ]
}
df <- rbind(dfi, dfs)
levs <- unique(df$id)
levs1 <- dfii
levs2 <- dfs$id
df$id <- factor(df$id, c(sort(levs1), sort(levs2)))
ggplot(df, aes(x=Dim1, y=Dim2, label=id, colour=id, size=id)) +
geom_text(show.legend=FALSE) +
scale_colour_manual(values=c("gray25", "gray50", rep("black", nrow(dfs))), guide="none") +
scale_size_manual(values=c(rep(ind.id.size, length(dfii)), rep(stim.id.size, nrow(dfs)))) +
scale_shape_discrete(name="ID", breaks=dfii, labels=dfii) +
theme_bw() + theme(aspect.ratio=1)
}
x <- plot.mlsmu6(out)
x
x+ labs(x="Dimension 1\nD=Democrat, R=Republican")
x+ labs(x="Dimension 1\nD=Democrat, R=Republican", y="Dimension 2")
library(asmcjr)
library(asmcjr)
out <- mlsmu6(input = interest1981[,9:38], ndim=2, cutoff=5,
id=factor(interest1981$party, labels=c("D", "R")))
out$iter
tail(out$iter)
plot(out)
plot(out) + labs(x="Dimension 1\nD=Democrat, R=Republican", y="Dimension 2")
inc.stims <- c("ada", "cope", "ccus", "cc", "ll", "nfu", "ntu",
"aft", "nfib", "ccause", "aclu", "ripon")
plot(out, selected.stims=inc.stims) +
labs(x="Dimension 1\nD=Democrat, R=Republican", y="Dimension 2")
library(asmcjr)
data"denmarkEES2009")
data("denmarkEES2009")
denmarkEES2009[1,]
input.den <- denmarkEES2009[,grep("q39", names(denmarkEES2009))]
input.den[1,]
input.den <- denmarkEES2009[,c("q39_p1","q39_p2","q39_p3",
"q39_p4","q39_p5","q39_p6","q39_p7","q39_p8")]
colnames(input.den) <- c("Social Democrats", "Danish Social Liberal Party",
"Conservative Peoples Party", "Socialist Peoples Party",
"Danish Peoples Party", "Liberal Party", "Liberal Alliance",
"June Movement")
input.den[1,]
input.den[which(input.den %in% c(77,88,89),
arr.ind=T)] <- NA
input.den[1:10, ]
input.den <- input.den[which(input.den %in% c(77,88,89),
arr.ind=T)] <- NA
input.den[1:10, ]
length(input.den)
input.den
input.den <- denmarkEES2009[,c("q39_p1","q39_p2","q39_p3",
"q39_p4","q39_p5","q39_p6","q39_p7","q39_p8")]
colnames(input.den) <- c("Social Democrats", "Danish Social Liberal Party",
"Conservative Peoples Party", "Socialist Peoples Party",
"Danish Peoples Party", "Liberal Party", "Liberal Alliance",
"June Movement")
which(input.den %in% c(77,88,89),
arr.ind=T)
input.den[,1]
class(input.den)
input.den <- as.matrix(denmarkEES2009[,c("q39_p1","q39_p2","q39_p3",
"q39_p4","q39_p5","q39_p6","q39_p7","q39_p8")])
colnames(input.den) <- c("Social Democrats", "Danish Social Liberal Party",
"Conservative Peoples Party", "Socialist Peoples Party",
"Danish Peoples Party", "Liberal Party", "Liberal Alliance",
"June Movement")
input.den <- input.den[which(input.den %in% c(77,88,89),
arr.ind=T)] <- NA
input.den
input.den <- as.matrix(denmarkEES2009[,c("q39_p1","q39_p2","q39_p3",
"q39_p4","q39_p5","q39_p6","q39_p7","q39_p8")])
colnames(input.den) <- c("Social Democrats", "Danish Social Liberal Party",
"Conservative Peoples Party", "Socialist Peoples Party",
"Danish Peoples Party", "Liberal Party", "Liberal Alliance",
"June Movement")
input.den[1,]
input.den <- input.den[input.den %in% c(77,88,89)] <- NA
dim(input.den)
input.den <- as.matrix(denmarkEES2009[,c("q39_p1","q39_p2","q39_p3",
"q39_p4","q39_p5","q39_p6","q39_p7","q39_p8")])
colnames(input.den) <- c("Social Democrats", "Danish Social Liberal Party",
"Conservative Peoples Party", "Socialist Peoples Party",
"Danish Peoples Party", "Liberal Party", "Liberal Alliance",
"June Movement")
input.den[1,]
input.den == 77
input.den[1,1] == 77
which(input.den %in% c(77,88,89))
which(input.den %in% c(77,88,89), arr.ind=TRUE)
length(unput.den)
length(input.den)
input.den <- as.matrix(denmarkEES2009[,c("q39_p1","q39_p2","q39_p3",
"q39_p4","q39_p5","q39_p6","q39_p7","q39_p8")])
colnames(input.den) <- c("Social Democrats", "Danish Social Liberal Party",
"Conservative Peoples Party", "Socialist Peoples Party",
"Danish Peoples Party", "Liberal Party", "Liberal Alliance",
"June Movement")
dim(input.den)
which(input.den %in% c(77,88,89), arr.ind=TRUE)
length(input.den)
dim(input.den)
class(input.den)
which
which(input.den %in% c(77,88,89), arr.ind = TRUE)
tmp <- input.den %in% c(77,88,89)
dim(tmp)
tmp
which(input.den == 77, arr.ind=TRUE)
input.den <- as.matrix(denmarkEES2009[,c("q39_p1","q39_p2","q39_p3",
"q39_p4","q39_p5","q39_p6","q39_p7","q39_p8")])
colnames(input.den) <- c("Social Democrats", "Danish Social Liberal Party",
"Conservative Peoples Party", "Socialist Peoples Party",
"Danish Peoples Party", "Liberal Party", "Liberal Alliance",
"June Movement")
input.den <- input.den[which(input.den == 77 | input.den == 88 |
input.den == 89, arr.ind=TRUE)] <- NA
input.den[1,]
dim(input.den)
input.den <- as.matrix(denmarkEES2009[,c("q39_p1","q39_p2","q39_p3",
"q39_p4","q39_p5","q39_p6","q39_p7","q39_p8")])
colnames(input.den) <- c("Social Democrats", "Danish Social Liberal Party",
"Conservative Peoples Party", "Socialist Peoples Party",
"Danish Peoples Party", "Liberal Party", "Liberal Alliance",
"June Movement")
T <- input.den
T[T==77 | T==88 | T==89] <- NA
T
input.den <- as.matrix(denmarkEES2009[,c("q39_p1","q39_p2","q39_p3",
"q39_p4","q39_p5","q39_p6","q39_p7","q39_p8")])
colnames(input.den) <- c("Social Democrats", "Danish Social Liberal Party",
"Conservative Peoples Party", "Socialist Peoples Party",
"Danish Peoples Party", "Liberal Party", "Liberal Alliance",
"June Movement")
input.den <- input.den[input.den == 77 | input.den == 88 |
input.den == 89] <- NA
input.den[1,]
input.den <- as.matrix(denmarkEES2009[,c("q39_p1","q39_p2","q39_p3",
"q39_p4","q39_p5","q39_p6","q39_p7","q39_p8")])
colnames(input.den) <- c("Social Democrats", "Danish Social Liberal Party",
"Conservative Peoples Party", "Socialist Peoples Party",
"Danish Peoples Party", "Liberal Party", "Liberal Alliance",
"June Movement")
input.den[1,]
T <- input.den
T[T==77 | T==88 | T==89] <- NA
dim(t)
dim(T)
input.den[input.den==77 | input.den==88 | input.den==89] <- NA
input.den
input.den <- (10-input.den)/5
cutoff <- 5
input.den <- input.den[rowSums(!is.na(input.den))>=cutoff,]
dim(input.den)
weightmat <- input.den
weightmat[!is.na(input.den)] <- 1
weightmat[is.na(input.den)] <- 0
input.den[is.na(input.den)] <- mean(input.den,na.rm=TRUE)
result <- smacofRect(delta=T, ndim=2, weightmat=weightmat, init=NULL,
verbose=FALSE, itmax= 1000, reg=0.000001, eps=0.000001)
library(smacof)
install.packages("smacof")
library(smacof)
result <- smacofRect(delta=T, ndim=2, weightmat=weightmat, init=NULL,
verbose=FALSE, itmax= 1000, reg=0.000001, eps=0.000001)
help(package=smacof)
?smacofRect
result <- smacofRect(delta=T, ndim=2, weightmat=weightmat, init=NULL,
verbose=FALSE, itmax= 1000)
result <- smacofRect(delta=input.den, ndim=2, weightmat=weightmat, init=NULL,
verbose=FALSE, itmax= 1000)
result
voters <- result$conf.row
parties <- result$conf.col
if (parties[1,1] > 0){
parties[,1] <- -1 * parties[,1]
voters[,1] <- -1 * voters[,1]
}
plot(parties[,1], parties[,2],
main="Estimated Configuration of Voters (circles) and Parties",
xlab="First Dimension", ylab="Second Dimension",
xlim=c(-2.5,2.5), ylim=c(-2.5,2.5), asp=1, type="n")
points(voters[,1], voters[,2], pch=1, col="gray")
text(parties[,1], parties[,2], c("A","B","C","F","O","V","I","J"),
col="black", cex=1.4, font=2)
legend("topleft", colnames(T),
pch=c("A","B","C","F","O","V","I","J"), col="black",
text.font=2, pt.cex=1, inset=.01, bty="n")
plot(result)
class(result)
plot.smacofR
smacof:::plot.smacofR
plot(result, label.conf.rows=list(label=FALSE))
plot(result, label.conf.rows=list(label=FALSE, pch=1))
plot(result, label.conf.rows=list(label=FALSE, pch=1, col="black"))
args(smacof:::plot.smacofR)
plot(result, label.conf.rows=list(label=FALSE), col.rows="black", pch=1)
plot(result, label.conf.rows=list(label=FALSE), col.rows="gray50", pch=1)
plot(result, label.conf.rows=list(label=FALSE), col.rows="gray50", pch=1, cex=.75)
plot(result, label.conf.rows=list(label=FALSE), col.rows="gray50", pch=1, cex=.75, col.columns = "black")
plot(result, label.conf.rows=list(label=FALSE), col.rows="gray50", pch=1, cex=.75, label.conf.columns=list(label=TRUE, col="black"))
plot(result, label.conf.rows=list(label=FALSE), col.rows="gray50", pch=1, cex=.75, label.conf.columns=list(label=TRUE, col="black", cex=1.5))
plot(result, label.conf.rows=list(label=FALSE), col.rows="gray50", pch=1, cex=.75, label.conf.columns=list(label=TRUE, col="black", cex=1))
plot(result, label.conf.rows=list(label=FALSE), col.rows="gray50", pch=1, cex=.75, label.conf.columns=list(label=TRUE, col="black", cex=1, pch=20))
plot(result, label.conf.rows=list(label=FALSE), col.rows="gray50", pch=rep(c(1,16), c(996, 8)), cex=.75, label.conf.columns=list(label=TRUE, col="black", cex=1))
plot(result, label.conf.rows=list(label=FALSE), col.rows="gray50", pch=1, cex=.75, label.conf.columns=list(label=TRUE, col="black", cex=1))
plot(result, label.conf.rows=list(label=FALSE), col.rows="gray50", pch=1, cex=.75, label.conf.columns=list(label=TRUE, col="black", cex=1), asp=1)
plot(result, label.conf.rows=list(label=FALSE), col.rows="gray50", pch=1, cex=.75, label.conf.columns=list(label=TRUE, col="black", cex=1), aspect.ratio=1)
plot(result, label.conf.rows=list(label=FALSE), col.rows="gray50", pch=1, cex=.75, label.conf.columns=list(label=TRUE, col="black", cex=1), xlim=c(-15,15))
plot(result, label.conf.rows=list(label=FALSE), col.rows="gray50", pch=1, cex=.75, label.conf.columns=list(label=TRUE, col="black", cex=1), xlim=c(-1.5,1.5))
plot(result, label.conf.rows=list(label=FALSE), col.rows="gray50", pch=1, cex=.75, label.conf.columns=list(label=TRUE, col="black", cex=1), xlim=c(-1.5,1.5), ylim=c(-1.5,1.5))
plot(result, label.conf.rows=list(label=FALSE), col.rows="gray50", pch=1, cex=.75, label.conf.columns=list(label=TRUE, col="black", cex=1), xlim=c(-1.5,1.5), ylim=c(-1.5,1.5),. asp=NULL)
plot(result, label.conf.rows=list(label=FALSE), col.rows="gray50", pch=1, cex=.75, label.conf.columns=list(label=TRUE, col="black", cex=1), xlim=c(-1.5,1.5), ylim=c(-1.5,1.5), asp=NULL)
par(pty="s")
plot(result, label.conf.rows=list(label=FALSE), col.rows="gray50", pch=1, cex=.75, label.conf.columns=list(label=TRUE, col="black", cex=1), xlim=c(-1.5,1.5), ylim=c(-1.5,1.5), asp=NULL)
library(basicspace)
LR <- denmarkEES2009[,c("q46","q47_p1","q47_p2","q47_p3",
"q47_p4","q47_p5","q47_p6","q47_p7","q47_p8")]
colnames(LR) <- c("Self","Social Democrats","Danish Social Liberal Party","Conservative Peoples Party",
"Socialist Peoples Party","Danish Peoples Party","Liberal Party",
"Liberal Alliance","June Movement")
mode(LR) <- "numeric"
AM.result <- aldmck(LR,polarity=2,respondent=1,missing=c(77,88,89,99),verbose=TRUE)
LR
class(LR)
LR <- as.matrix(LR)
colnames(LR) <- c("Self","Social Democrats","Danish Social Liberal Party","Conservative Peoples Party",
"Socialist Peoples Party","Danish Peoples Party","Liberal Party",
"Liberal Alliance","June Movement")
mode(LR) <- "numeric"
AM.result <- aldmck(LR,polarity=2,respondent=1,missing=c(77,88,89,99),verbose=TRUE)
ols <- lm(AM.result$stimuli ~ parties[,1] + parties[,2])
summary(ols)$coefficients
printCoefMat(summary(ols)$coefficients)
printCoefmat(summary(ols)$coefficients)
N1 <- ols$coefficients[2] /
(sqrt((ols$coefficients[2]^2) + (ols$coefficients[3]^2)))
N2 <- ols$coefficients[3] /
(sqrt((ols$coefficients[2]^2) + (ols$coefficients[3]^2)))
Na
N1
N2
exp.factor <- 3
segments(exp.factor*-N1, exp.factor*-N2,
exp.factor*N1, exp.factor*N2, lwd=2, lty=2)
text(2.1, -0.7, "Projection of\nLeft-Right\nScores", cex=1.1, font=2)
plot(parties[,1], parties[,2],
main="Estimated Configuration of Voters and Parties",
xlab="First Dimension", ylab="Second Dimension",
xlim=c(-2.5,2.5), ylim=c(-2.5,2.5), asp=1, type="n")
points(voters[,1], voters[,2], pch=1, col="gray")
text(parties[,1], parties[,2], c("A","B","C","F","O","V","I","J"),
col="black", cex=1.4, font=2)
legend("topleft", colnames(T),
pch=c("A","B","C","F","O","V","I","J"), col="black",
text.font=2, pt.cex=1, inset=.01, bty="n")
exp.factor <- 3
segments(exp.factor*-N1, exp.factor*-N2,
exp.factor*N1, exp.factor*N2, lwd=2, lty=2)
text(2.1, -0.7, "Projection of\nLeft-Right\nScores",
cex=1.1, font=2)
plot(parties[,1], parties[,2],
main="Estimated Configuration of Voters and Parties",
xlab="First Dimension", ylab="Second Dimension",
xlim=c(-2.5,2.5), ylim=c(-2.5,2.5), asp=1, type="n")
points(voters[,1], voters[,2], pch=1, col="gray")
text(parties[,1], parties[,2], c("A","B","C","F","O","V","I","J"),
col="black", cex=1.4, font=2)
legend("topleft", colnames(T),
pch=c("A","B","C","F","O","V","I","J"), col="black",
text.font=2, pt.cex=1, inset=.01, bty="n")
exp.factor <- 3
segments(exp.factor*-N1, exp.factor*-N2,
exp.factor*N1, exp.factor*N2, lwd=2, lty=2)
plot(parties[,1], parties[,2],
main="Estimated Configuration of Voters and Parties",
xlab="First Dimension", ylab="Second Dimension",
xlim=c(-2.5,2.5), ylim=c(-2.5,2.5), asp=1, type="n")
points(voters[,1], voters[,2], pch=1, col="gray")
text(parties[,1], parties[,2], c("A","B","C","F","O","V","I","J"),
col="black", cex=1.4, font=2)
legend("topleft", colnames(T),
pch=c("A","B","C","F","O","V","I","J"), col="black",
text.font=2, pt.cex=1, inset=.01, bty="n")
par(pty="s")
plot(result, label.conf.rows=list(label=FALSE),
col.rows="gray50", pch=1, cex=.75,
label.conf.columns=list(label=TRUE, col="black", cex=1),
xlim=c(-1.5,1.5), ylim=c(-1.5,1.5), asp=NULL)
exp.factor <- 3
segments(exp.factor*-N1, exp.factor*-N2,
exp.factor*N1, exp.factor*N2, lwd=2, lty=2)
getwd()
dyn.load("~/Dropbox/Spatial R Book 2 (1)/Draft/bayesianunfoldingmac.so")
ls()
library(asmcjr)
d
data()
data("ANES1968"
)
T <- ANES1968[,1:12]
T <- as.matrix(T)
vote.turnout <- ANES1968[,13]
presidential.vote <- ANES1968[,14]
print(T[1:5,1:6])
cutoff <- 5
vote.turnout <- vote.turnout[rowSums(!is.na(T))>=cutoff]
presidential.vote <- presidential.vote[rowSums(!is.na(T))>=cutoff]
T <- T[rowSums(!is.na(T))>=cutoff,]
T <- (100-T)/50
nrowX <- nrow(T)
ncolX <- ncol(T)
nburn <- 500
nslice <- 1500
NS <- 2
N <- NS*(nrowX+ncolX) - ((NS*(NS+1))/2)
NDIM <- NS*(nrowX+ncolX) - (NS-1)
UNFOLD <- 1
NMISSING <- 7
TT <- T
#This one creates errors for 22
TT[is.na(TT)] <- NA
X <- as.vector(t(TT))
CONSTRAINTS <- rep(1,NS*(nrowX+ncolX))
CONSTRAINTS[(NS*(nrowX+ncolX)-NS):(NS*(nrowX+ncolX))] <- 0
set_globals <- function(nslice,nburn,nrowX,ncolX,NS,N,NDIM,UNFOLD,
NMISSING,X,CONSTRAINTS) {
res <-  .C("copyFromR",
as.integer(nslice),
as.integer(nburn),
as.integer(nrowX),
as.integer(ncolX),
as.integer(NS),
as.integer(N),
as.integer(NDIM),
as.integer(UNFOLD),
as.integer(NMISSING),
as.double(X),
as.double(CONSTRAINTS))
}
set_globals(nslice,nburn,nrowX,ncolX,NS,N,NDIM,UNFOLD,
NMISSING,X,CONSTRAINTS)
dyn.load("c:/Dropbox/Spatial R Book/B-P_DS/lbfgs_jeff.dll")
dyn.load("~/Dropbox/Spatial R Book/B-P_DS/lbfgs_jeff.dll")
library(foreign)
dat <- read.dta("http://www.quantoid.net/files/9591/anes2008_binary.dta")
dat$race <- 1 + dat$white + 2*dat$black
dat$race <- factor(dat$race, levels=1:3, labels=c("Other", "White", "Black"))
mod <- glm(voted ~ age + educ + income + poly(leftright, 2) +
female + race, data=dat, family=binomial(link="logit"))
library(haven)
dat <- read_dta("http://www.quantoid.net/files/9591/anes2008_binary.dta")
dat$race <- 1 + dat$white + 2*dat$black
dat$race <- factor(dat$race, levels=1:3, labels=c("Other", "White", "Black"))
mod <- glm(voted ~ age + educ + income + poly(leftright, 2) +
female + race, data=dat, family=binomial(link="logit"))
summary(mod)
exp(.284)
X <- model.matrix(mod)
X <- model.matrix(mod)
X2 <- X
X[, "education"] <- 13
X2[, "education"] <- 17
colnames(X)
X <- model.matrix(mod)
X2 <- X
X[, "educ"] <- 13
X2[, "educ"] <- 17
p1 <- plogis(X %*% b)
p2 <- plogis(X2 %*% b)
b <- coef(mod)
p1 <- plogis(X %*% b)
p2 <- plogis(X2 %*% b)
m <- glm(voted ~ educ + female , data=dat, family=binomial(link="logit"))
summary(m)
m <- glm(voted ~ educ + race , data=dat, family=binomial(link="logit"))
summary(m)
predict(m , newdata=data.frame(educ=c(13,17), race="White"))
predict(m , newdata=data.frame(educ=c(13,17), race="White"), type="response")
diff(predict(m , newdata=data.frame(educ=c(13,17), race="White"), type="response"))
diff(predict(m , newdata=data.frame(educ=c(13,17), race="Black"), type="response"))
predict(m , newdata=data.frame(educ=c(13,17), race="Black"), type="response")
diff <- p2-p1
quartz()
hist(diff)
library(DAMisc)
glmChange(mod, dat, diffchange="sd")
library(devtools)
